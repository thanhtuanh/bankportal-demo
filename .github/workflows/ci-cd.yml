name: Bank Portal CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:
    inputs:
      environment:
        description: 'Deployment Environment'
        required: true
        default: 'dev'
        type: choice
        options:
          - dev
          - staging
          - prod

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}
  NODE_VERSION: '18'
  JAVA_VERSION: '17'

jobs:
  frontend-build-test:
    name: Frontend Build & Test
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./frontend
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
          cache-dependency-path: frontend/package-lock.json
      - run: npm ci
      - run: npm run lint
      - run: npm run test:ci
      # TODO: E2E-Tests vorerst deaktiviert
      # - run: npm run e2e:ci
      - run: npm run build:prod
      - uses: actions/upload-artifact@v4
        with:
          name: frontend-dist
          path: frontend/dist/
          retention-days: 30

  auth-service-build-test:
    name: Auth Service Build & Test
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./auth-service
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_DB: authdb_test
          POSTGRES_USER: test
          POSTGRES_PASSWORD: test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: ${{ env.JAVA_VERSION }}
          distribution: 'temurin'
          cache: maven
      - run: mvn test
        env:
          SPRING_DATASOURCE_URL: jdbc:postgresql://localhost:5432/authdb_test
          SPRING_DATASOURCE_USERNAME: test
          SPRING_DATASOURCE_PASSWORD: test
          JWT_SECRET: testsecretkeytestsecretkeytestsecretkey123456
      - run: mvn clean package -DskipTests
      - uses: actions/upload-artifact@v4
        with:
          name: auth-service-jar
          path: auth-service/target/*.jar
          retention-days: 30

  account-service-build-test:
    name: Account Service Build & Test
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./account-service
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_DB: accountdb_test
          POSTGRES_USER: test
          POSTGRES_PASSWORD: test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5433:5432
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: ${{ env.JAVA_VERSION }}
          distribution: 'temurin'
          cache: maven
      - run: mvn test
        env:
          SPRING_DATASOURCE_URL: jdbc:postgresql://localhost:5433/accountdb_test
          SPRING_DATASOURCE_USERNAME: test
          SPRING_DATASOURCE_PASSWORD: test
          JWT_SECRET: testsecretkeytestsecretkey123456
      - run: mvn clean package -DskipTests
      - uses: actions/upload-artifact@v4
        with:
          name: account-service-jar
          path: account-service/target/*.jar
          retention-days: 30

  sonar-auth-service:
    name: SonarQube Analysis - Auth Service
    runs-on: ubuntu-latest
    needs: [auth-service-build-test]
    defaults:
      run:
        working-directory: ./auth-service
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_DB: authdb_test
          POSTGRES_USER: test
          POSTGRES_PASSWORD: test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: 17
          distribution: 'temurin'
      - name: Cache SonarQube packages
        uses: actions/cache@v4
        with:
          path: ~/.sonar/cache
          key: ${{ runner.os }}-sonar
          restore-keys: ${{ runner.os }}-sonar
      - name: Cache Maven packages
        uses: actions/cache@v4
        with:
          path: ~/.m2
          key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
          restore-keys: ${{ runner.os }}-m2
      - name: Build and analyze Auth Service
        env:
          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
          SPRING_DATASOURCE_URL: jdbc:postgresql://localhost:5432/authdb_test
          SPRING_DATASOURCE_USERNAME: test
          SPRING_DATASOURCE_PASSWORD: test
          JWT_SECRET: testsecretkeytestsecretkeytestsecretkey123456
        run: |
          mvn -B verify org.sonarsource.scanner.maven:sonar-maven-plugin:sonar \
            -Dsonar.projectKey=thanhtuanh_bankportal-demo-auth-service \
            -Dsonar.projectName="Bank Portal Auth Service" \
            -Dsonar.organization=thanhtuanh \
            -Dsonar.host.url=https://sonarcloud.io

  sonar-account-service:
    name: SonarQube Analysis - Account Service
    runs-on: ubuntu-latest
    needs: [account-service-build-test]
    defaults:
      run:
        working-directory: ./account-service
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_DB: accountdb_test
          POSTGRES_USER: test
          POSTGRES_PASSWORD: test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5433:5432
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: 17
          distribution: 'temurin'
      - name: Cache SonarQube packages
        uses: actions/cache@v4
        with:
          path: ~/.sonar/cache
          key: ${{ runner.os }}-sonar
          restore-keys: ${{ runner.os }}-sonar
      - name: Cache Maven packages
        uses: actions/cache@v4
        with:
          path: ~/.m2
          key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
          restore-keys: ${{ runner.os }}-m2
      - name: Build and analyze Account Service
        env:
          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
          SPRING_DATASOURCE_URL: jdbc:postgresql://localhost:5433/accountdb_test
          SPRING_DATASOURCE_USERNAME: test
          SPRING_DATASOURCE_PASSWORD: test
          JWT_SECRET: testsecretkeytestsecretkey123456
        run: |
          mvn -B verify org.sonarsource.scanner.maven:sonar-maven-plugin:sonar \
            -Dsonar.projectKey=thanhtuanh_bankportal-demo-account-service \
            -Dsonar.projectName="Bank Portal Account Service" \
            -Dsonar.organization=thanhtuanh \
            -Dsonar.host.url=https://sonarcloud.io

  docker-build-push:
    name: Docker Build & Push
    runs-on: ubuntu-latest
    needs: [auth-service-build-test, account-service-build-test, frontend-build-test, sonar-auth-service, sonar-account-service]
    if: github.ref == 'refs/heads/main' || github.event_name == 'workflow_dispatch'
    permissions:
      contents: read
      packages: write
    steps:
      - uses: actions/checkout@v4

      - name: Bei GitHub Container Registry anmelden
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Docker Buildx einrichten
        uses: docker/setup-buildx-action@v3
        with:
          driver-opts: |
            image=moby/buildkit:v0.12.0

      - name: Auth Service Artifacts herunterladen
        uses: actions/download-artifact@v4
        with:
          name: auth-service-jar
          path: ./auth-service/target/

      - name: Account Service Artifacts herunterladen
        uses: actions/download-artifact@v4
        with:
          name: account-service-jar
          path: ./account-service/target/

      - name: Frontend Artifacts herunterladen
        uses: actions/download-artifact@v4
        with:
          name: frontend-dist
          path: ./frontend/dist/

      - name: Metadaten für Auth Service extrahieren
        id: meta-auth
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ github.repository }}-auth-service
          tags: |
            type=ref,event=branch
            type=ref,event=pr
            type=raw,value=latest,enable={{is_default_branch}}
            type=sha,prefix={{branch}}-

      - name: Auth Service Docker Image bauen und pushen
        uses: docker/build-push-action@v5
        with:
          context: ./auth-service
          platforms: linux/amd64,linux/arm64
          push: true
          tags: ${{ steps.meta-auth.outputs.tags }}
          labels: ${{ steps.meta-auth.outputs.labels }}
          provenance: false
          # GitHub Actions Cache temporär deaktiviert wegen Service-Problemen
          # cache-from: type=gha
          # cache-to: type=gha,mode=max

      - name: Metadaten für Account Service extrahieren
        id: meta-account
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ github.repository }}-account-service
          tags: |
            type=ref,event=branch
            type=ref,event=pr
            type=raw,value=latest,enable={{is_default_branch}}
            type=sha,prefix={{branch}}-

      - name: Account Service Docker Image bauen und pushen
        uses: docker/build-push-action@v5
        with:
          context: ./account-service
          platforms: linux/amd64,linux/arm64
          push: true
          tags: ${{ steps.meta-account.outputs.tags }}
          labels: ${{ steps.meta-account.outputs.labels }}
          provenance: false
          # GitHub Actions Cache temporär deaktiviert wegen Service-Problemen
          # cache-from: type=gha
          # cache-to: type=gha,mode=max

      - name: Metadaten für Frontend extrahieren
        id: meta-frontend
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ github.repository }}-frontend
          tags: |
            type=ref,event=branch
            type=ref,event=pr
            type=raw,value=latest,enable={{is_default_branch}}
            type=sha,prefix={{branch}}-

      - name: Frontend Docker Image bauen und pushen
        uses: docker/build-push-action@v5
        with:
          context: ./frontend
          platforms: linux/amd64,linux/arm64
          push: true
          tags: ${{ steps.meta-frontend.outputs.tags }}
          labels: ${{ steps.meta-frontend.outputs.labels }}
          provenance: false
          # GitHub Actions Cache temporär deaktiviert wegen Service-Problemen
          # cache-from: type=gha
          # cache-to: type=gha,mode=max

  generate-report:
    name: Generate Build Report
    runs-on: ubuntu-latest
    needs: [frontend-build-test, auth-service-build-test, account-service-build-test, sonar-auth-service, sonar-account-service, docker-build-push]
    if: always()
    steps:
      - name: Generate Summary Report
        run: |
          echo "# 🚀 Bank Portal CI/CD Report" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## 📊 Build Status" >> $GITHUB_STEP_SUMMARY
          echo "| Component | Status |" >> $GITHUB_STEP_SUMMARY
          echo "|-----------|--------|" >> $GITHUB_STEP_SUMMARY
          echo "| Frontend | ${{ needs.frontend-build-test.result == 'success' && '✅ Success' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
          echo "| Auth Service | ${{ needs.auth-service-build-test.result == 'success' && '✅ Success' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
          echo "| Account Service | ${{ needs.account-service-build-test.result == 'success' && '✅ Success' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
          echo "| SonarQube Auth | ${{ needs.sonar-auth-service.result == 'success' && '✅ Success' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
          echo "| SonarQube Account | ${{ needs.sonar-account-service.result == 'success' && '✅ Success' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
          echo "| Docker Build & Push | ${{ needs.docker-build-push.result == 'success' && '✅ Success' || '❌ Failed' }} |" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## 🔗 Quick Links" >> $GITHUB_STEP_SUMMARY
          echo "- [SonarCloud Auth Service](https://sonarcloud.io/project/overview?id=thanhtuanh_bankportal-demo-auth-service)" >> $GITHUB_STEP_SUMMARY
          echo "- [SonarCloud Account Service](https://sonarcloud.io/project/overview?id=thanhtuanh_bankportal-demo-account-service)" >> $GITHUB_STEP_SUMMARY
          echo "- [GitHub Container Registry](https://github.com/thanhtuanh/bankportal-demo/pkgs/container/bankportal-demo-auth-service)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## 📈 Pipeline Metriken" >> $GITHUB_STEP_SUMMARY
          echo "- **Repository:** \`${{ github.repository }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- **Branch:** \`${{ github.ref_name }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- **Commit:** \`${{ github.sha }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- **Triggered by:** ${{ github.event_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Built at:** $(date)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## 🎯 Nächste Schritte" >> $GITHUB_STEP_SUMMARY
          echo "- [ ] Code-Qualität in SonarCloud überprüfen" >> $GITHUB_STEP_SUMMARY
          echo "- [ ] Docker Images in GHCR kontrollieren" >> $GITHUB_STEP_SUMMARY
          echo "- [ ] Deployment planen" >> $GITHUB_STEP_SUMMARY

  update-readme:
    name: Update README Dashboard
    runs-on: ubuntu-latest
    needs: [generate-report]
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          persist-credentials: true

      - name: Update README Status
        run: |
          # Get real commit author name
          AUTHOR_NAME=$(git log -1 --pretty=format:'%an')
          
          # Check if we have the original README content
          if ! grep -q "🏦 Bank Portal – Eine zukunftssichere Finanzanwendung" README.md 2>/dev/null; then
            echo "Original README content not found. Restoring..."
            
            # Create original README content in a separate file first
            cat > original_readme.md << 'EOF'
# 🏦 Bank Portal – Eine zukunftssichere Finanzanwendung

Eine **moderne, mikroservice-basierte Banking-Plattform** mit einem responsiven Angular Frontend und einem robusten Spring Boot Backend, speziell entwickelt, um die hohen Anforderungen der Finanzbranche an **Sicherheit, Skalierbarkeit und Zuverlässigkeit** zu erfüllen.

-----

## 🎯 Überblick & Relevanz für die Bankenbranche

Das **Bank Portal** ist eine vollständige Banking-Anwendung, die **Kernfunktionen eines modernen Finanzinstituts** abbildet und dabei höchsten Wert auf **Sicherheit, Datenintegrität und Benutzerfreundlichkeit** legt. Dieses Projekt demonstriert meine Fähigkeit, komplexe **Softwarelösungen für regulierte Umfelder** zu entwickeln, die den Anforderungen an eine ausfallsichere und performante Bankensoftware gerecht werden.

**Hauptfunktionen:**

  - **Sichere Benutzerregistrierung und -anmeldung:** Umfassendes Authentifizierungs- und Autorisierungssystem.
  - **Robuste Kontoverwaltung:** Zuverlässige Erstellung, Anzeige und Verwaltung von Bankkonten.
  - **Auditierbare Geldtransfers:** Sichere und nachvollziehbare Transaktionen zwischen Konten.
  - **JWT-basierte Authentifizierung:** Standardkonforme und skalierbare Sicherheitsmechanismen.
  - **Responsives Angular Frontend:** Intuitive und zugängliche Benutzeroberfläche für verschiedene Endgeräte.
  - **Mikroservice-Architektur:** Ermöglicht flexible Skalierung und einfache Wartung der einzelnen Geschäftsbereiche.

-----

## 🛠️ Technologie-Stack

### Frontend
- **Angular 18+:** Framework für komplexe Single Page Applications
- **TypeScript:** Typsichere Entwicklung für robusten Code
- **SCSS:** Effizientes Styling für responsives Design

### Backend  
- **Spring Boot 3.x:** Enterprise Java-Framework
- **Spring Security:** Sicherheitsframework für Authentifizierung
- **PostgreSQL:** Robuste relationale Datenbank
- **JWT:** Token-basierte Authentifizierung
- **Docker:** Containerisierung für konsistente Deployments

-----

## 🚀 Installation & Setup

### Voraussetzungen
- **Node.js** (v18+) & **Angular CLI** für das Frontend
- **Java 17+** & **Maven 3.6+** für das Backend  
- **PostgreSQL 13+** als Datenbanksystem

### Backend Services Starten

```bash
# Auth Service
cd auth-service
mvn clean install
mvn spring-boot:run

# Account Service  
cd account-service
mvn clean install
mvn spring-boot:run
```

### Frontend Starten

```bash
cd frontend
npm install
ng serve
```

-----

## 📄 Lizenz

Dieses Projekt ist unter der **MIT Lizenz** veröffentlicht.

-----

**Version:** 1.0.0  
**Letztes Update:** Juli 2025
EOF
            
            # Replace current README with original content
            mv original_readme.md README.md
          fi
          
          # Remove any existing CI/CD status section
          if grep -q "<!-- CI/CD STATUS START -->" README.md 2>/dev/null; then
            sed '/<!-- CI/CD STATUS START -->/,$d' README.md > README.temp.md
            mv README.temp.md README.md
          fi
          
          # Append CI/CD status section
          cat >> README.md << 'CICD_EOF'
          
          <!-- CI/CD STATUS START -->
          
          -----
          
          ## 🤖 CI/CD Pipeline Status
          
          ![CI/CD Pipeline](https://github.com/thanhtuanh/bankportal-demo/workflows/Bank%20Portal%20CI%2FCD%20Pipeline/badge.svg)
          ![Last Commit](https://img.shields.io/github/last-commit/thanhtuanh/bankportal-demo)
          ![Repo Size](https://img.shields.io/github/repo-size/thanhtuanh/bankportal-demo)
          
          ### 📊 Aktueller Build Status
          
          | Service | Status | Letztes Update |
          |---------|--------|----------------|
          | 🔐 Auth Service | ✅ Build erfolgreich | 
          | 💰 Account Service | ✅ Build erfolgreich |
          | 🌐 Frontend | ✅ Build erfolgreich |
          | 🔍 SonarQube Analyse | ✅ Abgeschlossen |
          | 🐳 Docker Images | ✅ Zu GHCR gepusht |
          
          ### 🔗 Entwickler-Links
          
          - **🔍 Code-Qualität:** [SonarCloud Dashboard](https://sonarcloud.io/organizations/thanhtuanh/projects)
          - **🐳 Container Images:** [GitHub Container Registry](https://github.com/thanhtuanh/bankportal-demo/pkgs)
          - **📋 CI/CD Pipeline:** [GitHub Actions](https://github.com/thanhtuanh/bankportal-demo/actions)
          
          ### 📈 Letzte Pipeline-Aktivität
          
          - **Letzter Commit:** `3f506c0`
          - **Branch:** `main`  
          - **Autor:** Duc Thanh Nguyen
          - **Build-Zeit:** 
          - **Ausgelöst durch:** push
          
          ### 🛠️ DevOps Pipeline
          
          | Phase | Tool | Status |
          |-------|------|--------|
          | Build | Maven + npm | ✅ |
          | Tests | JUnit + Jest | ✅ |
          | Code-Qualität | SonarCloud | ✅ |
          | Containerisierung | Docker + GHCR | ✅ |
          | CI/CD | GitHub Actions | ✅ |
          
          > **Hinweis:** Diese Pipeline demonstriert moderne DevOps-Praktiken für die Bankenbranche mit automatisierten Tests, Code-Qualitätsprüfungen und sicherer Container-Bereitstellung.
          
          -----
          *🤖 Automatisch aktualisiert durch GitHub Actions Pipeline*
          
          <!-- CI/CD STATUS END -->
          CICD_EOF
          
          # Update dynamic values
          CURRENT_DATE=$(date '+%d.%m.%Y %H:%M:%S')
          sed -i "s/| 🔐 Auth Service | ✅ Build erfolgreich | /| 🔐 Auth Service | ✅ Build erfolgreich | ${CURRENT_DATE} |/g" README.md
          sed -i "s/| 💰 Account Service | ✅ Build erfolgreich |/| 💰 Account Service | ✅ Build erfolgreich | ${CURRENT_DATE} |/g" README.md
          sed -i "s/| 🌐 Frontend | ✅ Build erfolgreich |/| 🌐 Frontend | ✅ Build erfolgreich | ${CURRENT_DATE} |/g" README.md
          sed -i "s/| 🔍 SonarQube Analyse | ✅ Abgeschlossen |/| 🔍 SonarQube Analyse | ✅ Abgeschlossen | ${CURRENT_DATE} |/g" README.md
          sed -i "s/| 🐳 Docker Images | ✅ Zu GHCR gepusht |/| 🐳 Docker Images | ✅ Zu GHCR gepusht | ${CURRENT_DATE} |/g" README.md
          sed -i "s/- \*\*Build-Zeit:\*\* /- **Build-Zeit:** ${CURRENT_DATE}/g" README.md
# 🏦 Bank Portal – Eine zukunftssichere Finanzanwendung

Eine **moderne, mikroservice-basierte Banking-Plattform** mit einem responsiven Angular Frontend und einem robusten Spring Boot Backend, speziell entwickelt, um die hohen Anforderungen der Finanzbranche an **Sicherheit, Skalierbarkeit und Zuverlässigkeit** zu erfüllen.

-----

## 🎯 Überblick & Relevanz für die Bankenbranche

Das **Bank Portal** ist eine vollständige Banking-Anwendung, die **Kernfunktionen eines modernen Finanzinstituts** abbildet und dabei höchsten Wert auf **Sicherheit, Datenintegrität und Benutzerfreundlichkeit** legt. Dieses Projekt demonstriert meine Fähigkeit, komplexe **Softwarelösungen für regulierte Umfelder** zu entwickeln, die den Anforderungen an eine ausfallsichere und performante Bankensoftware gerecht werden.

**Hauptfunktionen:**

  - **Sichere Benutzerregistrierung und -anmeldung:** Umfassendes Authentifizierungs- und Autorisierungssystem.
  - **Robuste Kontoverwaltung:** Zuverlässige Erstellung, Anzeige und Verwaltung von Bankkonten.
  - **Auditierbare Geldtransfers:** Sichere und nachvollziehbare Transaktionen zwischen Konten.
  - **JWT-basierte Authentifizierung:** Standardkonforme und skalierbare Sicherheitsmechanismen.
  - **Responsives Angular Frontend:** Intuitive und zugängliche Benutzeroberfläche für verschiedene Endgeräte.
  - **Mikroservice-Architektur:** Ermöglicht flexible Skalierung und einfache Wartung der einzelnen Geschäftsbereiche.

-----

## 🏗️ Architektur & Skalierbarkeit

Die Anwendung ist in einer **modernen Mikroservice-Architektur** aufgebaut, die **Agilität, Skalierbarkeit und Resilienz** fördert – entscheidende Faktoren für die dynamische Bankenlandschaft. Die klare Trennung von Verantwortlichkeiten (Auth- und Account-Services) minimiert Abhängigkeiten und ermöglicht eine unabhängige Entwicklung und Bereitstellung.

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│                 │     │                 │     │                 │
│   Angular SPA   │────►│   Auth Service  │────►│ Account Service │
│   (Port 4200)   │     │   (Port 8081)   │     │   (Port 8082)   │
│                 │     │                 │     │                 │
└─────────────────┘     └─────────────────┘     └─────────────────┘
                               │                       │
                               ▼                       ▼
                        ┌─────────────────┐     ┌─────────────────┐
                        │   PostgreSQL    │     │   PostgreSQL    │
                        │   (Auth DB)     │     │ (Account DB)    │
                        │   Port 5432     │     │ Port 5433       │
                        └─────────────────┘     └─────────────────┘
```

### Services & Verantwortlichkeiten:

1.  **Frontend (Angular):**
      * **User Experience (UX):** Single Page Application mit responsivem Design für eine nahtlose Benutzerführung.
      * **Sichere Client-Seite:** JWT Token Management und Route Guards zum Schutz sensibler Bereiche.
      * **Effiziente Kommunikation:** HTTP Client für die performante Interaktion mit den Backend-Services.
2.  **Auth Service (Spring Boot):**
      * **Identitätsmanagement:** Sichere Benutzerregistrierung und Login/Logout-Funktionalität.
      * **Token-Ausstellung:** Robuste JWT Token Generation für authentifizierte Sitzungen.
      * **Passwort-Sicherheit:** Industriestandard BCrypt Hashing für den Schutz von Benutzerpasswörtern.
3.  **Account Service (Spring Boot):**
      * **Kern-Finanzlogik:** Verwaltung von Konten und Abwicklung von Geldtransfers.
      * **Geschäftslogik-Implementierung:** Kapselung komplexer Bankprozesse.
      * **Autorisierung:** JWT Token Validation zur Sicherstellung berechtigter Zugriffe auf Finanzdaten.

-----

## 🛠️ Technologie-Stack – Bewährte Enterprise-Technologien

Dieses Projekt nutzt einen modernen und branchenüblichen Technologie-Stack, der für **Stabilität, Performance und langfristige Wartbarkeit** in Unternehmensumgebungen, insbesondere im Bankensektor, konzipiert ist.

### Frontend

  - **Angular 18+:** Führendes Framework für komplexe Single Page Applications, ideal für interaktive Finanzportale.
  - **TypeScript:** Typsichere Entwicklung für robusten und wartbaren Frontend-Code.
  - **SCSS:** Effizientes Styling für ein konsistentes und responsives Design.
  - **RxJS:** Reactive Programming für die Handhabung asynchroner Datenströme, essenziell für Echtzeit-Updates.
  - **Angular Router:** Umfassendes Navigationssystem mit Schutzmechanismen (Guards).
  - **HTTP Client:** Standard für die sichere und effiziente API-Kommunikation.

### Backend

  - **Spring Boot 3.x:** De-facto-Standard für Java-Backend-Entwicklung in der Enterprise-Welt, bekannt für Produktivität und Stabilität.
  - **Spring Security:** Umfassendes Sicherheitsframework für Authentifizierung und Autorisierung.
  - **Spring Data JPA:** Effizienter und sicherer Datenzugriff auf relationale Datenbanken.
  - **PostgreSQL:** Robuste, Open-Source relationale Datenbank, die für ihre Zuverlässigkeit und Datenintegrität geschätzt wird.
  - **JWT (JSON Web Tokens):** Standard für token-basierte, zustandslose Authentifizierung.
  - **BCrypt:** Bewährter Algorithmus für sicheres Passwort-Hashing.
  - **Lombok:** Zur Reduzierung von Boilerplate-Code und Verbesserung der Lesbarkeit.

### Tools & Testing

  - **JUnit 5:** Modernes Testing Framework für Unit- und Integrationstests.
  - **Mockito:** Beliebtes Mocking Framework für isolierte Testfälle.
  - **Maven:** Standardisiertes Build-Management-Tool für Java-Projekte.
  - **Docker:** Containerisierung für konsistente Entwicklung, Test- und Produktionsumgebungen.

-----

## 🔒 Sicherheit & Compliance – Fundament des Vertrauens

Die Sicherheit sensibler Finanzdaten ist von größter Bedeutung. Dieses Projekt implementiert eine Reihe von **robusten Sicherheitsmaßnahmen**, die den Anforderungen der Bankenbranche an Datenschutz und Transaktionssicherheit Rechnung tragen.

### Implementierte Sicherheitsmaßnahmen:

1.  **JWT Tokens:**
      * **Stateless Authentication:** Fördert Skalierbarkeit und reduziert Serverlast.
      * **Konfigurierbare Ablaufzeiten (24h Standard):** Für eine flexible Sicherheitspolitik.
      * **HMAC-SHA256 Signing:** Gewährleistet die Integrität und Authentizität der Tokens.
2.  **Passwort-Sicherheit:**
      * **BCrypt Hashing (Salted):** Starker Schutz vor Brute-Force-Angriffen und Rainbow-Table-Angriffen.
      * **Mindestlängen-Validierung:** Erzwingt robuste Passwörter.
3.  **API Security:**
      * **Umfassender Schutz aller Account-APIs:** Nur authentifizierte und autorisierte Zugriffe sind möglich.
      * **Token-Validierung bei jeder Anfrage:** Kontinuierliche Überprüfung der Berechtigung.
      * **Automatischer Logout bei 401-Fehlern:** Sofortige Reaktion auf ungültige oder abgelaufene Tokens.
4.  **CORS Configuration:**
      * **Gezielte Konfiguration für `localhost:4200`:** Verhindert unautorisierte Cross-Origin-Zugriffe im Entwicklungsbetrieb. In Produktion flexibel anpassbar.
      * **Kontrollierte Zugriffs-Header:** Ermöglicht sichere Interaktionen zwischen Frontend und Backend.
5.  **Input Validation:**
      * **Frontend-Formularvalidierung:** Schnelles Feedback für den Benutzer.
      * **Backend DTO-Validierung:** Robuste serverseitige Validierung kritischer Daten.
      * **SQL Injection Prevention (JPA):** Schutz vor einer der häufigsten Web-Sicherheitslücken durch den Einsatz von ORM-Technologien.

-----

## 🧪 Qualitätssicherung & Teststrategie

Ein hoher Qualitätsanspruch, der sich in der **Codequalität und dem Testing** widerspiegelt, ist für Finanzanwendungen unerlässlich. Dieses Projekt demonstriert eine konsequente Teststrategie, um die **Funktionalität, Robustheit und Fehlerfreiheit** der Software zu gewährleisten.

### Backend Tests ausführen

```bash
# Auth Service Tests
cd auth-service
mvn test

# Account Service Tests
cd account-service
mvn test
```

### Testabdeckung & Szenarien:

  * **Auth Service Tests:** Abdeckung kritischer Authentifizierungsflüsse.
      * ✅ `loginBenutzerNichtGefunden()`: Testet das Szenario, wenn ein Benutzer nicht existiert.
      * ✅ `loginFalschesPasswort()`: Überprüft die korrekte Handhabung falscher Passwörter.
      * ✅ `loginErfolgreich()`: Validiert den erfolgreichen Anmeldevorgang.
      * ✅ `registerErfolgreich()`: Stellt sicher, dass neue Benutzer korrekt registriert werden können.
      * ✅ `registerExistiertBereits()`: Prüft die Ablehnung doppelter Registrierungen.
  * **Account Service Tests:** Fokus auf finanzrelevante Geschäftslogik.
      * ✅ `testGetAllAccounts()`: Verifiziert die korrekte Abfrage aller Konten.
      * ✅ `testCreateAccount()`: Testet die Erstellung neuer Konten.
      * ✅ `testTransferThrowsIfAccountNotFound()`: Stellt sicher, dass Transfers bei nicht existierenden Konten fehlschlagen.
      * ✅ `testTransferThrowsIfNotEnoughMoney()`: Prüft, ob Transfers bei unzureichendem Guthaben korrekt abgelehnt werden.

### Frontend Tests

```bash
cd frontend
npm test
```

Die Frontend-Tests stellen die korrekte Funktionalität der Benutzeroberfläche und die Integration mit den Backend-APIs sicher.

-----

## 🚀 Installation & Setup

Um das Bank Portal lokal in Betrieb zu nehmen, folgen Sie diesen Schritten:

### Voraussetzungen

  - **Node.js** (v18+) & **Angular CLI** (`npm install -g @angular/cli`) für das Frontend.
  - **Java 17+** & **Maven 3.6+** für das Backend.
  - **PostgreSQL 13+** (lokal oder via Docker) als Datenbanksystem.

### 1\. Repository Klonen

```bash
git clone <repository-url>
cd bank-portal
```

### 2\. Datenbank Setup

#### Option A: Docker (Empfohlen für schnelle Einrichtung)

```bash
# Auth Service Database
docker run --name postgres-auth -e POSTGRES_DB=authdb -e POSTGRES_USER=admin -e POSTGRES_PASSWORD=admin -p 5432:5432 -d postgres:13

# Account Service Database
docker run --name postgres-account -e POSTGRES_DB=accountdb -e POSTGRES_USER=admin -e POSTGRES_PASSWORD=admin -p 5433:5432 -d postgres:13
```

#### Option B: Lokale PostgreSQL Installation

```sql
-- Auth Database
CREATE DATABASE authdb;
CREATE USER admin WITH PASSWORD 'admin';
GRANT ALL PRIVILEGES ON DATABASE authdb TO admin;

-- Account Database
CREATE DATABASE accountdb;
GRANT ALL PRIVILEGES ON DATABASE accountdb TO admin;
```

### 3\. Backend Services Starten

#### Auth Service

```bash
cd auth-service
mvn clean install
mvn spring-boot:run
```

Der Auth Service ist dann unter `http://localhost:8081` erreichbar.

#### Account Service

```bash
cd account-service
mvn clean install
mvn spring-boot:run
```

Der Account Service ist dann unter `http://localhost:8082` erreichbar.

### 4\. Frontend Starten

```bash
cd frontend
npm install
ng serve
```

Das Frontend ist dann unter `http://localhost:4200` erreichbar.

-----

## ⚙️ Konfiguration

### Environment Variables

Stellen Sie sicher, dass die folgenden Umgebungsvariablen gesetzt sind, insbesondere das **JWT Secret**, welches in beiden Services identisch sein muss, um die korrekte Funktion der Authentifizierung zu gewährleisten.

```bash
# JWT Secret (muss in beiden Services identisch sein)
export JWT_SECRET=mysecretkeymysecretkeymysecretkey123456

# Database URLs
export AUTH_DB_URL=jdbc:postgresql://localhost:5432/authdb
export ACCOUNT_DB_URL=jdbc:postgresql://localhost:5433/accountdb
```

### Application Properties

#### Auth Service (`application.properties`)

```properties
server.port=8081
spring.datasource.url=${AUTH_DB_URL:jdbc:postgresql://localhost:5432/authdb}
spring.datasource.username=admin
spring.datasource.password=admin
jwt.secret=${JWT_SECRET:mysecretkeymysecretkeymysecretkey123456}
jwt.expiration-ms=86400000
```

#### Account Service (`application.properties`)

```properties
server.port=8082
spring.datasource.url=${ACCOUNT_DB_URL:jdbc:postgresql://localhost:5433/accountdb}
spring.datasource.username=admin
spring.datasource.password=admin
jwt.secret=${JWT_SECRET:mysecretkeymysecretkeymysecretkey123456}
```

-----

## 📡 API Dokumentation

Die RESTful APIs der Mikroservices sind klar strukturiert und ermöglichen eine einfache Integration.

### Auth Service APIs

#### POST `/api/auth/register`

Registriert einen neuen Benutzer im System.

**Request Body:**

```json
{
  "username": "testuser",
  "password": "password123"
}
```

**Response:** `201 Created`

```json
{
  "message": "✅ Benutzer erfolgreich registriert"
}
```

#### POST `/api/auth/login`

Authentifiziert einen Benutzer und gibt einen JWT Token zurück.

**Request Body:**

```json
{
  "username": "testuser",
  "password": "password123"
}
```

**Response:** `200 OK`

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

### Account Service APIs

> **Hinweis:** Alle Account Service APIs erfordern den `Authorization: Bearer <token>` Header für den Zugriff.

#### GET `/api/accounts`

Ruft alle Konten ab, die dem authentifizierten Benutzer zugeordnet sind.

**Response:** `200 OK`

```json
[
  {
    "id": 1,
    "owner": "Max Mustermann",
    "balance": 1000.50
  }
]
```

#### POST `/api/accounts`

Erstellt ein neues Bankkonto für den authentifizierten Benutzer.

**Request Body:**

```json
{
  "owner": "Anna Schmidt",
  "balance": 500.00
}
```

**Response:** `200 OK`

```json
{
  "id": 2,
  "owner": "Anna Schmidt",
  "balance": 500.00
}
```

#### POST `/api/accounts/transfer`

Führt einen Geldtransfer zwischen zwei Konten durch.

**Request Body:**

```json
{
  "fromAccountId": 1,
  "toAccountId": 2,
  "amount": 100.00
}
```

**Response:** `200 OK`

```text
✅ Transfer successful
```

-----

## 🎨 Frontend Features – Benutzerfreundlichkeit & Effizienz

Das Angular Frontend ist auf eine **intuitive Benutzerführung und Effizienz** ausgelegt, um ein optimales Banking-Erlebnis zu gewährleisten.

### Schlüsselkomponenten & Services

1.  **LoginComponent / RegisterComponent:** Sichere Einstiegspunkte für Benutzer.
2.  **DashboardComponent:** Zentrale Übersicht über die wichtigsten Finanzdaten.
3.  **AccountListComponent:** Detaillierte Ansicht und Verwaltung der Konten.
4.  **NavigationComponent:** Benutzerfreundliche Navigation und sichere Abmeldung.
5.  **AuthService:** Zentrales Management für Authentifizierung und Token-Handhabung.
6.  **AccountService:** Kapselung der Geschäftslogik für Kontoverwaltung und Transfers.
7.  **AuthGuard:** Schutz kritischer Routen vor unautorisiertem Zugriff.
8.  **AuthInterceptor:** Automatische Integration von JWT Tokens in API-Anfragen.

### Features Highlights

  - ✅ **Responsives Design:** Optimale Darstellung auf allen Geräten (Desktop, Tablet, Mobile).
  - ✅ **Echtzeit-Validierung:** Sofortiges Feedback bei Formulareingaben zur Verbesserung der Datenqualität.
  - ✅ **Loading States & Error Handling:** Robuste Benutzerführung auch bei asynchronen Operationen und Fehlern.
  - ✅ **Währungsformatierung (EUR):** Fachgerechte Darstellung von Finanzbeträgen.
  - ✅ **Automatischer Logout bei Token-Expiry:** Erhöhte Sicherheit durch automatische Sitzungsbeendigung.
  - ✅ **Deutsche Lokalisierung:** Anpassung an den deutschsprachigen Markt.

-----

## 📝 Code-Struktur & Wartbarkeit

Eine **klare und modulare Code-Struktur** ist entscheidend für die Wartbarkeit und Erweiterbarkeit in der Finanzbranche. Die Projekte sind nach Best Practices organisiert, um die Zusammenarbeit im Team und die Einarbeitung neuer Entwickler zu erleichtern.

### Frontend (`/frontend`)

```
src/
├── app/
│   ├── components/            # UI Komponenten (z.B. Login, Register, Dashboard, Account List, Navigation)
│   ├── services/              # Business Logic (z.B. AuthService, AccountService)
│   ├── models/                # TypeScript Interfaces für Datenstrukturen
│   ├── guards/                # Route Guards für Zugriffskontrolle
│   ├── interceptors/          # HTTP Interceptors für Request-Transformation
│   └── app.routes.ts          # Routing Konfiguration
├── styles.scss                # Globale Styles
└── index.html                 # Haupt-HTML-Datei
```

### Backend Auth Service (`/auth-service`)

```
src/main/java/com/bankportal/authservice/
├── controller/                # REST Controllers für API-Endpunkte
├── service/                   # Business Logic Implementierungen
├── repository/                # Datenzugriffsschicht (JPA Repositories)
├── model/                     # JPA Entities (Datenbankmodelle)
├── dto/                       # Data Transfer Objects für API-Kommunikation
├── security/                  # Sicherheitskonfiguration (Spring Security, JWT)
└── config/                    # Allgemeine Anwendungskonfiguration
```

### Backend Account Service (`/account-service`)

```
src/main/java/com/example/bank/
├── AccountController.java     # REST Controller für Kontenoperationen
├── AccountService.java        # Geschäftslogik für Konten und Transfers
├── AccountRepository.java     # Datenzugriff für Konten
├── Account.java               # JPA Entity für Kontendaten
├── AccountDto.java            # DTO für Kontendaten
├── TransferRequest.java       # DTO für Transferanfragen
├── SecurityConfig.java        # Sicherheitskonfiguration & JWT Validierung
└── GlobalExceptionHandler.java# Zentrales Fehlerhandling
```

-----

## 🚀 Deployment & Betrieb

Das Projekt ist für eine einfache Containerisierung mit **Docker** vorbereitet, was eine konsistente Bereitstellung in verschiedenen Umgebungen (Entwicklung, Test, Produktion) ermöglicht – ein wichtiger Aspekt für **DevOps-Pipelines** in Banken.

### Production Build

#### Frontend

```bash
cd frontend
ng build --configuration production
```

#### Backend

```bash
# Auth Service
cd auth-service
mvn clean package -Pprod

# Account Service
cd account-service
mvn clean package -Pprod
```

### Docker Deployment

Beispiel-Dockerfile für die Backend-Services zur einfachen Containerisierung:

```dockerfile
# Beispiel Dockerfile für Backend
FROM openjdk:17-jre-slim
COPY target/auth-service-*.jar app.jar
EXPOSE 8081
ENTRYPOINT ["java", "-jar", "/app.jar"]
```

-----

## 🐛 Troubleshooting

Eine detaillierte Anleitung zur Fehlerbehebung ist für den reibungslosen Betrieb in einer Produktivumgebung essenziell.

### Häufige Probleme & Lösungen

#### 1\. "Connection refused" Fehler

**Problem:** Frontend kann Backend-Services nicht erreichen.
**Lösung:** Prüfen Sie, ob die Backend-Services (Auth, Account) auf den korrekten Ports laufen (`netstat -tlnp`) und starten Sie sie gegebenenfalls neu.

#### 2\. JWT Token Fehler

**Problem:** "Invalid or expired token".
**Lösung:** Melden Sie sich erneut an, überprüfen Sie das `JWT_SECRET` in beiden Services und die Token-Ablaufzeit.

#### 3\. Datenbank Connection Fehler

**Problem:** "Connection to database failed".
**Lösung:** Überprüfen Sie den Status der PostgreSQL-Instanzen (lokal oder Docker) und testen Sie die Datenbankverbindung.

#### 4\. CORS Fehler

**Problem:** "Access to fetch blocked by CORS policy".
**Lösung:** Überprüfen Sie die CORS-Konfiguration in `SecurityConfig.java` der Backend-Services und stellen Sie sicher, dass die Frontend-URL korrekt in `allowedOrigins` gesetzt ist.

#### 5\. Port Konflikte

**Problem:** "Port already in use".
**Lösung:** Finden Sie den Prozess, der den Port belegt, und beenden Sie ihn (`lsof -ti:<PORT> | xargs kill -9`).

### Logs

Für eine effektive Fehleranalyse in einer Bankenumgebung sind detaillierte Logs unerlässlich.

#### Backend Logs anzeigen

```bash
# Mit Maven
mvn spring-boot:run | grep -E "(ERROR|WARN|INFO)"

# Application Logs
tail -f logs/application.log
```

#### Frontend Logs

Verwenden Sie die Browser Developer Tools (Konsole) für Frontend-spezifische Fehler.

### Debug Mode

```bash
# Backend mit Debug
mvn spring-boot:run -Dspring.profiles.active=debug

# Frontend mit Debug
ng serve --verbose
```

-----

## Screenshot

[Frontend UI-Screenshots (PDF)](docs/frontend.pdf) – Ein visueller Einblick in die Anwendung.

-----

## 📄 Lizenz

Dieses Projekt ist unter der **MIT Lizenz** veröffentlicht, was die Nutzung und Modifikation unter den gegebenen Bedingungen erlaubt.

-----

**Version:** 1.0.0  
**Letztes Update:** Juli 2025
ORIGINAL_EOF
          fi
          
          # Now remove any existing CI/CD status section if present
          if grep -q "<!-- CI/CD STATUS START -->" README.md 2>/dev/null; then
            sed '/<!-- CI/CD STATUS START -->/,$d' README.md > README.temp.md
            mv README.temp.md README.md
          fi
          
          # Append the CI/CD status section
          cat >> README.md << EOF
          
          <!-- CI/CD STATUS START -->
          
          -----
          
          ## 🤖 CI/CD Pipeline Status
          
          ![CI/CD Pipeline](https://github.com/${{ github.repository }}/workflows/Bank%20Portal%20CI%2FCD%20Pipeline/badge.svg)
          ![Last Commit](https://img.shields.io/github/last-commit/${{ github.repository }})
          ![Repo Size](https://img.shields.io/github/repo-size/${{ github.repository }})
          
          ### 📊 Aktueller Build Status
          
          | Service | Status | Letztes Update |
          |---------|--------|----------------|
          | 🔐 Auth Service | ✅ Build erfolgreich | $(date '+%d.%m.%Y %H:%M:%S') |
          | 💰 Account Service | ✅ Build erfolgreich | $(date '+%d.%m.%Y %H:%M:%S') |
          | 🌐 Frontend | ✅ Build erfolgreich | $(date '+%d.%m.%Y %H:%M:%S') |
          | 🔍 SonarQube Analyse | ✅ Abgeschlossen | $(date '+%d.%m.%Y %H:%M:%S') |
          | 🐳 Docker Images | ✅ Zu GHCR gepusht | $(date '+%d.%m.%Y %H:%M:%S') |
          
          ### 🔗 Entwickler-Links
          
          - **🔍 Code-Qualität:** [SonarCloud Dashboard](https://sonarcloud.io/organizations/thanhtuanh/projects)
          - **🐳 Container Images:** [GitHub Container Registry](https://github.com/${{ github.repository }}/pkgs)
          - **📋 CI/CD Pipeline:** [GitHub Actions](https://github.com/${{ github.repository }}/actions)
          - **📊 Pipeline Report:** [Letzter Lauf](https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }})
          
          ### 📈 Letzte Pipeline-Aktivität
          
          - **Letzter Commit:** \`${{ github.sha }}\`
          - **Branch:** \`${{ github.ref_name }}\`
          - **Autor:** ${AUTHOR_NAME}
          - **Build-Zeit:** $(date '+%d.%m.%Y %H:%M:%S')
          - **Ausgelöst durch:** ${{ github.event_name }}
          
          ### 🛠️ DevOps Pipeline
          
          | Phase | Tool | Status |
          |-------|------|--------|
          | Build | Maven + npm | ✅ |
          | Tests | JUnit + Jest | ✅ |
          | Code-Qualität | SonarCloud | ✅ |
          | Containerisierung | Docker + GHCR | ✅ |
          | CI/CD | GitHub Actions | ✅ |
          
          > **Hinweis:** Diese Pipeline demonstriert moderne DevOps-Praktiken für die Bankenbranche mit automatisierten Tests, Code-Qualitätsprüfungen und sicherer Container-Bereitstellung.
          
          -----
          *🤖 Automatisch aktualisiert durch GitHub Actions Pipeline - $(date '+%d.%m.%Y %H:%M:%S')*
          
          <!-- CI/CD STATUS END -->
          EOF](https://img.shields.io/github/repo-size/${{ github.repository }})
          
          ### 📊 Aktueller Build Status
          
          | Service | Status | Letztes Update |
          |---------|--------|----------------|
          | 🔐 Auth Service | ✅ Build erfolgreich | $(date '+%d.%m.%Y %H:%M:%S') |
          | 💰 Account Service | ✅ Build erfolgreich | $(date '+%d.%m.%Y %H:%M:%S') |
          | 🌐 Frontend | ✅ Build erfolgreich | $(date '+%d.%m.%Y %H:%M:%S') |
          | 🔍 SonarQube Analyse | ✅ Abgeschlossen | $(date '+%d.%m.%Y %H:%M:%S') |
          | 🐳 Docker Images | ✅ Zu GHCR gepusht | $(date '+%d.%m.%Y %H:%M:%S') |
          
          ### 🔗 Entwickler-Links
          
          - **🔍 Code-Qualität:** [SonarCloud Dashboard](https://sonarcloud.io/organizations/thanhtuanh/projects)
          - **🐳 Container Images:** [GitHub Container Registry](https://github.com/${{ github.repository }}/pkgs)
          - **📋 CI/CD Pipeline:** [GitHub Actions](https://github.com/${{ github.repository }}/actions)
          - **📊 Pipeline Report:** [Letzter Lauf](https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }})
          
          ### 📈 Letzte Pipeline-Aktivität
          
          - **Letzter Commit:** \`${{ github.sha }}\`
          - **Branch:** \`${{ github.ref_name }}\`
          - **Autor:** \${AUTHOR_NAME}
          - **Build-Zeit:** $(date '+%d.%m.%Y %H:%M:%S')
          - **Ausgelöst durch:** ${{ github.event_name }}
          
          ### 🛠️ DevOps Pipeline
          
          | Phase | Tool | Status |
          |-------|------|--------|
          | Build | Maven + npm | ✅ |
          | Tests | JUnit + Jest | ✅ |
          | Code-Qualität | SonarCloud | ✅ |
          | Containerisierung | Docker + GHCR | ✅ |
          | CI/CD | GitHub Actions | ✅ |
          
          > **Hinweis:** Diese Pipeline demonstriert moderne DevOps-Praktiken für die Bankenbranche mit automatisierten Tests, Code-Qualitätsprüfungen und sicherer Container-Bereitstellung.
          
          -----
          *🤖 Automatisch aktualisiert durch GitHub Actions Pipeline - $(date '+%d.%m.%Y %H:%M:%S')*
          
          <!-- CI/CD STATUS END -->
          EOF

      - name: Commit README
        run: |
          git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add README.md
          if git diff --staged --quiet; then
            echo "Keine Änderungen in README.md"
          else
            git commit -m "📊 Update README dashboard [skip ci]"
            git push
          fi